üöÄ –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –Ω–æ–≤–∞—è —Å—Ö–µ–º–∞
–£–ª—É—á—à–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
–≠–¢–ê–ü 1: structured_vacancy_analysis() ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏
         ‚Üì
–≠–¢–ê–ü 2: structured_resume_analysis() ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ  
         ‚Üì
–≠–¢–ê–ü 3: precise_matching() ‚Üí –¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ –Ω–∞–≤—ã–∫–æ–≤
         ‚Üì
–≠–¢–ê–ü 4: generate_letter_from_matches() ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–æ—Ç–æ–≤—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
üìã –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∞–Ω–∞–ª–∏–∑–∞
üéØ –≠–¢–ê–ü 1: –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏
pythonVACANCY_ANALYSIS_PROMPT = """
–ó–ê–î–ê–ß–ê: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å —Ä–µ–∑—é–º–µ.

–ê–õ–ì–û–†–ò–¢–ú –ê–ù–ê–õ–ò–ó–ê –í–ê–ö–ê–ù–°–ò–ò:

1. –ñ–Å–°–¢–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø (hard requirements):
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (–≥–æ–¥—ã, —Å—Ñ–µ—Ä—ã)
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ/—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
   - –Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è/–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

2. –ú–Ø–ì–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø (soft requirements):
   - –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ–ø—ã—Ç
   - –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞
   - –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ —Ä–∞–±–æ—Ç—ã

3. –ö–õ–Æ–ß–ï–í–´–ï –ë–ò–ó–ù–ï–°-–ó–ê–î–ê–ß–ò:
   - –ß—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏
   - –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–∞—Ç—å
   - –ö–∞–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–∂–∏–¥–∞—é—Ç—Å—è

4. –ö–û–ù–¢–ï–ö–°–¢ –ö–û–ú–ü–ê–ù–ò–ò:
   - –†–∞–∑–º–µ—Ä –∫–æ–º–ø–∞–Ω–∏–∏/–∫–æ–º–∞–Ω–¥—ã
   - –û—Ç—Ä–∞—Å–ª—å –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞
   - –≠—Ç–∞–ø —Ä–∞–∑–≤–∏—Ç–∏—è (—Å—Ç–∞—Ä—Ç–∞–ø/–∫–æ—Ä–ø–æ—Ä–∞—Ü–∏—è)
   - –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞

5. –ö–õ–Æ–ß–ï–í–´–ï –°–õ–û–í–ê –ò –¢–ï–†–ú–ò–ù–´:
   - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
   - –û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
   - –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã
   - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: JSON
{
  "hard_requirements": [
    {
      "requirement": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ",
      "importance": "critical/high/medium",
      "specificity": "specific/general",
      "keywords": ["–∫–ª—é—á–µ–≤—ã–µ", "—Å–ª–æ–≤–∞"]
    }
  ],
  "soft_requirements": [...],
  "business_tasks": [...],
  "company_context": {...},
  "key_terms": [...]
}
"""
üë§ –≠–¢–ê–ü 2: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ
pythonRESUME_ANALYSIS_PROMPT = """
–ó–ê–î–ê–ß–ê: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤ –∏ –æ–ø—ã—Ç–∞ –∏–∑ —Ä–µ–∑—é–º–µ.

–ê–õ–ì–û–†–ò–¢–ú –ê–ù–ê–õ–ò–ó–ê –†–ï–ó–Æ–ú–ï:

1. –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ù–ê–í–´–ö–ò:
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
   - –£—Ä–æ–≤–µ–Ω—å –≤–ª–∞–¥–µ–Ω–∏—è (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

2. –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –û–ü–´–¢:
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–æ–ª–∏ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å —Ü–∏—Ñ—Ä–∞–º–∏
   - –ü—Ä–æ–µ–∫—Ç—ã –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –ò–Ω–¥—É—Å—Ç—Ä–∏–∏ –∏ —Å—Ñ–µ—Ä—ã

3. –ë–ò–ó–ù–ï–°-–†–ï–ó–£–õ–¨–¢–ê–¢–´:
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ KPI
   - –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
   - –†–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
   - –°–æ–∑–¥–∞–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

4. –û–ë–†–ê–ó–û–í–ê–ù–ò–ï –ò –°–ï–†–¢–ò–§–ò–ö–ê–¢–´:
   - –§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
   - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
   - –ö—É—Ä—Å—ã –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∏

5. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ê–ö–¢–ò–í–ù–û–°–¢–ò:
   - –í–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤–æ
   - –ü—Ä–æ–µ–∫—Ç—ã –≤ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è
   - –ü—É–±–ª–∏–∫–∞—Ü–∏–∏/–≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è
   - –•–æ–±–±–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–∞–±–æ—Ç–æ–π

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: JSON
{
  "technical_skills": [
    {
      "skill": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –Ω–∞–≤—ã–∫",
      "level": "beginner/intermediate/advanced/expert",
      "context": "–≥–¥–µ –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª",
      "results": "–∫–∞–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ—Å—Ç–∏–≥",
      "keywords": ["–∫–ª—é—á–µ–≤—ã–µ", "—Å–ª–æ–≤–∞"]
    }
  ],
  "experience": [...],
  "achievements": [...],
  "education": [...],
  "additional": [...]
}
"""
üîó –≠–¢–ê–ü 3: –¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
pythonMATCHING_ALGORITHM_PROMPT = """
–ó–ê–î–ê–ß–ê: –ù–∞–π—Ç–∏ –¢–û–ß–ù–´–ï —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –º–µ–∂–¥—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ –Ω–∞–≤—ã–∫–∞–º–∏ –≤ —Ä–µ–∑—é–º–µ.

–ê–õ–ì–û–†–ò–¢–ú –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø:

1. –ü–†–Ø–ú–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (exact matches):
   - –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
   - –ü–æ—Ö–æ–∂–∏–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
   - –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏
   - –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

2. –°–ò–õ–¨–ù–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (strong matches):
   - –°–º–µ–∂–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (React ‚Üí Vue.js)
   - –ü–µ—Ä–µ–Ω–æ—Å–∏–º—ã–π –æ–ø—ã—Ç (B2B –ø—Ä–æ–¥–∞–∂–∏ ‚Üí B2C –ø—Ä–æ–¥–∞–∂–∏)
   - –ü–æ—Ö–æ–∂–∏–µ —Ä–æ–ª–∏ (Team Lead ‚Üí Project Manager)

3. –°–õ–ê–ë–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (weak matches):
   - –û–±—â–∏–µ –Ω–∞–≤—ã–∫–∏ (–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è, –ª–∏–¥–µ—Ä—Å—Ç–≤–æ)
   - –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (MS Office, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)

4. –ü–†–û–ë–ï–õ–´ (gaps):
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∂—ë—Å—Ç–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
   - –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–π –æ–ø—ã—Ç
   - –ù–µ—Ö–≤–∞—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤

–ü–†–ê–í–ò–õ–ê –û–¶–ï–ù–ö–ò –°–û–í–ü–ê–î–ï–ù–ò–ô:
- –£—á–∏—Ç—ã–≤–∞—Ç—å –ö–û–ù–¢–ï–ö–°–¢ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–≤—ã–∫–∞
- –ò—Å–∫–∞—Ç—å –ö–û–õ–ò–ß–ï–°–¢–í–ï–ù–ù–´–ï —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã  
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –°–ü–ï–¶–ò–§–ò–ß–ù–û–°–¢–¨ –Ω–∞–¥ –æ–±—â–Ω–æ—Å—Ç—å—é
- –í—ã–¥–µ–ª—è—Ç—å –£–ù–ò–ö–ê–õ–¨–ù–´–ï –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: JSON
{
  "exact_matches": [
    {
      "requirement": "—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏",
      "match": "—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ —Ä–µ–∑—é–º–µ", 
      "strength": "exact/strong/weak",
      "evidence": "–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞",
      "impact": "—Ä–µ–∑—É–ª—å—Ç–∞—Ç/–º–µ—Ç—Ä–∏–∫–∞"
    }
  ],
  "strong_matches": [...],
  "weak_matches": [...],
  "gaps": [...],
  "unique_advantages": [...]
}
"""
‚úçÔ∏è –≠–¢–ê–ü 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
pythonLETTER_GENERATION_PROMPT = """
–ó–ê–î–ê–ß–ê: –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ì–û–¢–û–í–û–ì–û –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.

–£ —Ç–µ–±—è –µ—Å—Ç—å:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏
- –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ  
- –¢–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ –Ω–∞–≤—ã–∫–æ–≤
- –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

–ê–õ–ì–û–†–ò–¢–ú –ù–ê–ü–ò–°–ê–ù–ò–Ø –ü–ò–°–¨–ú–ê:

1. –û–¢–ë–û–† –õ–£–ß–®–ò–• –°–û–í–ü–ê–î–ï–ù–ò–ô:
   - –í—ã–±–µ—Ä–∏ 5-7 —Å–∞–º—ã—Ö —Å–∏–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–π exact_matches –∏ strong_matches
   - –ò–≥–Ω–æ—Ä–∏—Ä—É–π weak_matches –∏ –æ–±—â–∏–µ –Ω–∞–≤—ã–∫–∏

2. –°–û–ó–î–ê–ù–ò–ï "–ú–û–°–¢–û–í":
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è: "–í–∞–º –≤–∞–∂–Ω–æ X ‚Üí –£ –º–µ–Ω—è –µ—Å—Ç—å Y —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º Z"
   - –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏ —Ñ–∞–∫—Ç—ã
   - –ü–æ–∫–∞–∂–∏ –¶–ï–ù–ù–û–°–¢–¨ –¥–ª—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è

3. –°–¢–†–£–ö–¢–£–†–ê –ü–ò–°–¨–ú–ê:
   - –ê–±–∑–∞—Ü 1: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è + —Ç–æ–ø-1 —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
   - –ê–±–∑–∞—Ü 2-3: 4-6 –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
   - –ê–±–∑–∞—Ü 4: –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ + –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é

4. –†–ê–ë–û–¢–ê –° –ü–†–û–ë–ï–õ–ê–ú–ò:
   - –ù–ï —É–ø–æ–º–∏–Ω–∞–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞–≤—ã–∫–∏
   - –ù–∞–π–¥–∏ —Å–º–µ–∂–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
   - –ü–æ–∫–∞–∂–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–≤–∏—Ç–∏—é

–ö–õ–Æ–ß–ï–í–´–ï –ü–†–ò–ù–¶–ò–ü–´:
- –ö–∞–∂–¥–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ = –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–∫—Ç
- –§–æ–∫—É—Å –Ω–∞ –†–ï–ó–£–õ–¨–¢–ê–¢–ê–•, –∞ –Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¶–ò–§–†–´ –∏ –ú–ï–¢–†–ò–ö–ò
- –ò–∑–±–µ–≥–∞—Ç—å –æ–±—â–∏—Ö —Ñ—Ä–∞–∑ –∏ –∫–ª–∏—à–µ

–í–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:
{ready_analysis}
"""


# –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å –∞–Ω–∞–ª–∏–∑–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏ –≤–µ–±-–ø–æ–∏—Å–∫–æ–º

class EnhancedLetterGenerator:
    """–£–ª—É—á—à–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å –∞–Ω–∞–ª–∏–∑–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏"""
    
    async def generate_full_analysis_and_letter(self, vacancy_text, resume_text):
        """
        –ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: –ê–Ω–∞–ª–∏–∑ ‚Üí –°–æ–≤–ø–∞–¥–µ–Ω–∏—è ‚Üí –ü–∏—Å—å–º–æ ‚Üí –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
        """
        
        # –≠–¢–ê–ü 1: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ (—Å –≤–µ–±-–ø–æ–∏—Å–∫–æ–º)
        logger.info("üîç –≠–¢–ê–ü 1: –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ + –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–º–ø–∞–Ω–∏–∏...")
        vacancy_analysis = await self.analyze_vacancy_with_context(vacancy_text)
        
        # –≠–¢–ê–ü 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ  
        logger.info("üë§ –≠–¢–ê–ü 2: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ...")
        resume_analysis = await self.analyze_resume_structured(resume_text)
        
        # –≠–¢–ê–ü 3: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        logger.info("‚ö° –≠–¢–ê–ü 3: –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π...")
        matching_analysis = await self.detailed_matching_analysis(
            vacancy_analysis, resume_analysis
        )
        
        # –≠–¢–ê–ü 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞
        logger.info("‚úçÔ∏è –≠–¢–ê–ü 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞...")
        letter = await self.generate_letter_from_analysis(matching_analysis)
        
        # –≠–¢–ê–ü 5: –î–µ-–ò–ò-—Ñ–∏–∫–∞—Ü–∏—è
        logger.info("üîß –≠–¢–ê–ü 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞...")
        final_letter = await self.deai_text(letter)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏ –ø–∏—Å—å–º–æ –ò –∞–Ω–∞–ª–∏–∑
        return {
            'letter': final_letter,
            'analysis': self.format_matching_summary(matching_analysis),
            'company_context': vacancy_analysis.get('company_context', {}),
            'recommendations': self.generate_recommendations(matching_analysis)
        }

    async def analyze_vacancy_with_context(self, vacancy_text):
        """–ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ —Å –ø–æ–∏—Å–∫–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏"""
        
        # –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏
        base_analysis = await self.analyze_vacancy_structured(vacancy_text)
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
        company_name = self.extract_company_name(vacancy_text)
        
        if company_name:
            # –í–µ–±-–ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏
            company_context = await self.research_company(company_name)
            base_analysis['company_context'] = company_context
            
            # –ü–æ–∏—Å–∫ –æ—Ç—Ä–∞—Å–ª–µ–≤—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏
            industry_context = await self.research_industry_trends(
                base_analysis.get('industry', ''),
                base_analysis.get('key_terms', [])
            )
            base_analysis['industry_context'] = industry_context
        
        return base_analysis

    async def research_company(self, company_name):
        """–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫"""
        
        # –ü–æ–∏—Å–∫ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        basic_info = await self.web_search(f"{company_name} –∫–æ–º–ø–∞–Ω–∏—è –æ –Ω–∞—Å")
        
        # –ü–æ–∏—Å–∫ –æ—Ç–∑—ã–≤–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        employee_reviews = await self.web_search(f"{company_name} –æ—Ç–∑—ã–≤—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ hh.ru")
        
        # –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ —Å–æ–±—ã—Ç–∏–π
        recent_news = await self.web_search(f"{company_name} –Ω–æ–≤–æ—Å—Ç–∏ 2024 2025")
        
        return {
            'size': self.determine_company_size(basic_info),
            'industry': self.extract_industry(basic_info),
            'culture': self.analyze_culture(employee_reviews),
            'recent_events': self.extract_recent_events(recent_news),
            'growth_stage': self.determine_growth_stage(basic_info, recent_news)
        }

    async def detailed_matching_analysis(self, vacancy_analysis, resume_analysis):
        """–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏"""
        
        prompt = f"""
        –ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ —Ä–µ–∑—é–º–µ —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

        –ê–ù–ê–õ–ò–ó –í–ê–ö–ê–ù–°–ò–ò: {vacancy_analysis}
        –ê–ù–ê–õ–ò–ó –†–ï–ó–Æ–ú–ï: {resume_analysis}

        –ê–õ–ì–û–†–ò–¢–ú –ê–ù–ê–õ–ò–ó–ê –°–û–í–ü–ê–î–ï–ù–ò–ô:

        1. –ü–†–Ø–ú–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (90-100% match):
           - –¢–æ—á–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
           - –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–π –æ–ø—ã—Ç
           - –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏
           
        2. –°–ò–õ–¨–ù–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (70-89% match):
           - –°–º–µ–∂–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
           - –ü–µ—Ä–µ–Ω–æ—Å–∏–º—ã–π –æ–ø—ã—Ç
           - –ü–æ—Ö–æ–∂–∏–µ —Ä–æ–ª–∏ —Å –¥–æ–ø. –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é
           
        3. –ß–ê–°–¢–ò–ß–ù–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø (40-69% match):
           - –ë–∞–∑–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏
           - –û–±—â–∏–π –æ–ø—ã—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏
           - –°—Ö–æ–∂–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
           
        4. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–ï–õ–´:
           - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∂–µ—Å—Ç–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
           - –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –æ–ø—ã—Ç
           
        5. –°–ö–†–´–¢–´–ï –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
           - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
           - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
           - –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

        –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: JSON —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è/–ø—Ä–æ–±–µ–ª–∞
        """
        
        return await self.openai_service.get_completion(prompt)

    def format_matching_summary(self, matching_analysis):
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        
        summary = """
        üìä –ê–ù–ê–õ–ò–ó –°–û–í–ü–ê–î–ï–ù–ò–ô –í–ê–ö–ê–ù–°–ò–ò –ò –†–ï–ó–Æ–ú–ï

        ‚úÖ –°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´:
        {strong_matches}

        ‚ö° –ß–ê–°–¢–ò–ß–ù–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø:
        {partial_matches}

        ‚ö†Ô∏è –û–ë–õ–ê–°–¢–ò –î–õ–Ø –†–ê–ó–í–ò–¢–ò–Ø:
        {gaps}

        üéØ –£–ù–ò–ö–ê–õ–¨–ù–´–ï –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
        {unique_advantages}

        üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
        {recommendations}
        """
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞
        return summary.format(
            strong_matches=self.format_matches(matching_analysis.get('strong_matches', [])),
            partial_matches=self.format_matches(matching_analysis.get('partial_matches', [])),
            gaps=self.format_gaps(matching_analysis.get('gaps', [])),
            unique_advantages=self.format_advantages(matching_analysis.get('unique_advantages', [])),
            recommendations=self.format_recommendations(matching_analysis.get('recommendations', []))
        )

    async def research_industry_trends(self, industry, key_terms):
        """–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏–Ω–æ–≤"""
        
        if not industry or not key_terms:
            return {}
            
        # –ü–æ–∏—Å–∫ —Ç—Ä–µ–Ω–¥–æ–≤ –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏
        trends_query = f"{industry} —Ç—Ä–µ–Ω–¥—ã 2024 2025 —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"
        trends_info = await self.web_search(trends_query)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
        terms_relevance = {}
        for term in key_terms[:5]:  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
            term_query = f"{term} {industry} –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω–æ—Å—Ç—å 2024"
            term_info = await self.web_search(term_query)
            terms_relevance[term] = self.analyze_term_relevance(term_info)
        
        return {
            'trends': self.extract_trends(trends_info),
            'terms_relevance': terms_relevance,
            'market_demand': self.analyze_market_demand(trends_info)
        }

# –ù–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –±–æ—Ç–∞
class EnhancedConversationHandler:
    """–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å –∞–Ω–∞–ª–∏–∑–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π"""
    
    async def handle_resume_and_generate(self, update, context):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—é–º–µ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–∏—Å—å–º–∞ –ò –∞–Ω–∞–ª–∏–∑–∞"""
        
        resume_text = update.message.text
        vacancy_text = context.user_data['vacancy']
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        progress_msg = await update.message.reply_text(
            "üîÑ –°–æ–∑–¥–∞—é –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ –∏ –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π...\n\n"
            "‚è≥ –≠—Ç–æ –∑–∞–π–º–µ—Ç 30-45 —Å–µ–∫—É–Ω–¥\n"
            "üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∫–æ–º–ø–∞–Ω–∏—é –∏ –≤–∞–∫–∞–Ω—Å–∏—é\n"
            "üë§ –ò–∑—É—á–∞—é –≤–∞—à–µ —Ä–µ–∑—é–º–µ\n"
            "‚ö° –ò—â—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞\n"
            "‚úçÔ∏è –ì–µ–Ω–µ—Ä–∏—Ä—É—é –ø–∏—Å—å–º–æ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ"
        )
        
        try:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑
            result = await self.generator.generate_full_analysis_and_letter(
                vacancy_text, resume_text
            )
            
            # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
            await progress_msg.delete()
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ
            await update.message.reply_text(
                f"‚úçÔ∏è <b>–°–û–ü–†–û–í–û–î–ò–¢–ï–õ–¨–ù–û–ï –ü–ò–°–¨–ú–û:</b>\n\n{result['letter']}",
                parse_mode='HTML'
            )
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            await update.message.reply_text(
                f"üìä <b>–ê–ù–ê–õ–ò–ó –°–û–í–ü–ê–î–ï–ù–ò–ô:</b>\n\n{result['analysis']}",
                parse_mode='HTML'
            )
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–º–ø–∞–Ω–∏–∏ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
            if result.get('company_context'):
                company_summary = self.format_company_context(result['company_context'])
                await update.message.reply_text(
                    f"üè¢ <b>–ö–û–ù–¢–ï–ö–°–¢ –ö–û–ú–ü–ê–ù–ò–ò:</b>\n\n{company_summary}",
                    parse_mode='HTML'
                )
            
            # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–∏—Å—å–º–∞
            keyboard = InlineKeyboardMarkup([[
                InlineKeyboardButton("üîÑ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø–∏—Å—å–º–æ", callback_data="start_new")
            ]])
            
            await update.message.reply_text(
                "üéâ –ì–æ—Ç–æ–≤–æ! –ü–∏—Å—å–º–æ –∏ –∞–Ω–∞–ª–∏–∑ —Å–æ–∑–¥–∞–Ω—ã.",
                reply_markup=keyboard
            )
            
        except Exception as e:
            await progress_msg.delete()
            await update.message.reply_text(
                "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑."
            )
            logger.error(f"Generation error: {e}")
        
        return ConversationHandler.END

# üìã –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ù–û–í–û–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–´

## üéØ –¶–µ–ª—å
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 4-—ç—Ç–∞–ø–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∞–Ω–∞–ª–∏–∑–∞:
1. –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è  
2. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
3. –¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ‚Üí –æ—Ü–µ–Ω–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ ‚Üí –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–æ—Ç–æ–≤—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

## üìù –≠–¢–ê–ü–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –≠–¢–ê–ü 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ smart_analyzer.py (–ö–†–ò–¢–ò–ß–ù–û) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
**–ó–∞–¥–∞—á–∏:**
- [x] –î–æ–±–∞–≤–∏—Ç—å 4 –Ω–æ–≤—ã—Ö –ø—Ä–æ–º–ø—Ç–∞ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –¢–ó
- [x] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –º–µ—Ç–æ–¥ `generate_full_letter()` ‚Üí `generate_full_analysis_and_letter()`
- [x] –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
  - `analyze_vacancy_structured()`
  - `analyze_resume_structured()`  
  - `detailed_matching_analysis()`
  - `generate_letter_from_analysis()`
  - `format_matching_summary()`
- [x] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º API

**–ù–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã:**
- `VACANCY_ANALYSIS_PROMPT` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏
- `RESUME_ANALYSIS_PROMPT` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ  
- `MATCHING_ANALYSIS_PROMPT` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
- `LETTER_GENERATION_PROMPT` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞

### –≠–¢–ê–ü 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ simple_conversation.py (–í–ê–ñ–ù–û) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
**–ó–∞–¥–∞—á–∏:**
- [x] –ò–∑–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤ –≤ `handle_resume_simple()`: 
  - –ó–∞–º–µ–Ω–∏—Ç—å `analyze_and_generate()` –Ω–∞ `analyze_and_generate_with_analysis()`
- [x] –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- [x] –£–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ (4 —ç—Ç–∞–ø–∞)
- [x] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:**
```python
result = {
    'letter': '–≥–æ—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ',
    'analysis': '—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π'
}
```

### –≠–¢–ê–ü 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ openai_service.py (–ü–û–î–î–ï–†–ñ–ö–ê)
**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `get_structured_analysis()` –¥–ª—è JSON –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `parse_json_safely()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- [ ] –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –≠–¢–ê–ü 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ utils/prompts.py (–û–†–ì–ê–ù–ò–ó–ê–¶–ò–Ø)
**–ó–∞–¥–∞—á–∏:**
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã –∏–∑ smart_analyzer.py
- [ ] –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üîÑ –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –®–ê–ì 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ smart_analyzer.py
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –∞–Ω–∞–ª–∏–∑–∞
3. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≥–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ `generate_full_analysis_and_letter()`
4. –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–ê–ì 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
1. –ò–∑–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤ –≤ `handle_resume_simple()`
2. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π  
3. –£–ª—É—á—à–∏—Ç—å UX —Å –ø–æ–∫–∞–∑–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### –®–ê–ì 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–ª–æ—É
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
3. –£–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç–æ–≤ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

**–î–æ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–∏—Å—å–º–æ
- –û–¥–∏–Ω –±–æ–ª—å—à–æ–π –ø—Ä–æ–º–ø—Ç-–∞–Ω–∞–ª–∏–∑
- –ù–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

**–ü–æ—Å–ª–µ:**  
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–æ + –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
- 4-—ç—Ç–∞–ø–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –∏ –ø—Ä–æ–±–µ–ª–æ–≤
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø–∏—Å—å–º–∞

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ:
- [ ] –í—Å–µ 4 —ç—Ç–∞–ø–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- [ ] JSON –ø–∞—Ä—Å–∏—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫  
- [ ] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- [ ] –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 45 —Å–µ–∫—É–Ω–¥

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ:
- [ ] –ü–∏—Å—å–º–∞ —Å—Ç–∞–ª–∏ –±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏
- [ ] –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–æ–Ω—è—Ç–µ–Ω –∏ –ø–æ–ª–µ–∑–µ–Ω
- [ ] UX —É–ª—É—á—à–∏–ª—Å—è —Å –ø–æ–∫–∞–∑–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- [ ] –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∏—Å–µ–º

## üöÄ –ì–û–¢–û–í –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

–ü–ª–∞–Ω —Å–æ—Å—Ç–∞–≤–ª–µ–Ω, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≠–¢–ê–ü–ê 1!