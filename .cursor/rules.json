{
  "ai_prompts": [
    "НИКОГДА не изменяй UNIFIED_ANALYSIS_PROMPT без explicit approval",
    "Промпты версионируются отдельно - создавай _v7, _v8 копии",
    "При изменении промптов - обязательно A/B тест"
  ],
  "database": [
    "НЕ трогай supabase_schema.sql напрямую - только через миграции",
    "Все изменения схемы через отдельные .sql файлы",
    "Проверяй RLS политики при добавлении таблиц/полей",
    "Analytics запросы батчить - не по одному event"
  ],
  "ai_services": [
    "Всегда сохраняй fallback механизмы OpenAI ↔ Claude",
    "Логируй AI requests с tokens и response_time",
    "Не убирай error handling для AI APIs",
    "Timeout для AI запросов - максимум 60 секунд"
  ],
  "performance": [
    "Проверяй N+1 query problems в analytics",
    "Кэшируй user limits и subscription data",
    "Батчи для user_events вместо отдельных INSERT",
    "Async/await для всех DB операций"
  ],
  "security": [
    "НЕ логируй PII (ФИО, телефоны, email из резюме)",
    "Все user inputs валидировать на длину и содержимое",
    "Rate limiting для всех user actions",
    "Environment variables только через config.py"
  ],
  "telegram": [
    "ConversationHandler state должен быть persistent",
    "Callback query handlers с proper error handling",
    "Keyboard markup через utils/keyboards.py",
    "Все сообщения через message templates"
  ],
  "release_management": [
    "Вся работа ведется в папке 'releases/'. Никогда не создавай задачи или миграции вне релиза.",
    "Новая задача = новый файл в 'releases/vXX_feature_name/tasks/' из шаблона 'templates/task_template.md'.",
    "Новая миграция БД = новый файл в 'releases/vXX_feature_name/migrations/' из шаблона 'templates/migration_template.sql'.",
    "Завершенные релизы ПЕРЕМЕЩАЮТСЯ в 'releases/archive/completed_releases/'. Не изменять содержимое архива без прямого указания.",
    "Файл 'releases/current/active_tasks.md' - это high-level статус. Обновляй его при изменении статуса релиза (старт, пауза, завершение, архивация).",
    "При любом изменении кода, которое затрагивает архитектуру, путь пользователя или конфигурацию, ОБЯЗАТЕЛЬНО проверь и предложи обновить 'docs/ARCHITECTURE.md', 'docs/CJM.md' и 'docs/CONFIG_REFERENCE.md'."
  ]
} 