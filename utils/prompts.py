"""
Промпты для SmartAnalyzer v6.0
Только актуальные промпты, legacy убран
"""

# ============ АНАЛИЗ ВАКАНСИИ ============

VACANCY_ANALYSIS_PROMPT = """
ЗАДАЧА: Структурированный анализ вакансии для точного сопоставления с резюме.

АЛГОРИТМ АНАЛИЗА ВАКАНСИИ:

1. ЖЁСТКИЕ ТРЕБОВАНИЯ (hard requirements):
   - Обязательные технические навыки/инструменты
   - Конкретный опыт работы (годы, сферы)
   - Обязательное образование/сертификаты
   - Языки программирования/платформы

2. МЯГКИЕ ТРЕБОВАНИЯ (soft requirements):
   - Желательные навыки
   - Дополнительный опыт
   - Личностные качества
   - Методологии работы

3. КЛЮЧЕВЫЕ БИЗНЕС-ЗАДАЧИ:
   - Что конкретно нужно делать на позиции
   - Какие проблемы решать
   - Какие результаты ожидаются

4. КОНТЕКСТ КОМПАНИИ:
   - Размер компании/команды
   - Отрасль и специфика
   - Этап развития (стартап/корпорация)
   - Корпоративная культура

5. КЛЮЧЕВЫЕ СЛОВА И ТЕРМИНЫ:
   - Специфичные технологии
   - Отраслевые термины
   - Методологии и процессы
   - Инструменты и платформы

ФОРМАТ ОТВЕТА: JSON
{{
  "hard_requirements": [
    {{
      "requirement": "конкретное требование",
      "importance": "critical/high/medium",
      "specificity": "specific/general",
      "keywords": ["ключевые", "слова"]
    }}
  ],
  "soft_requirements": [...],
  "business_tasks": [...],
  "company_context": {{}},
  "key_terms": [...]
}}

ВАКАНСИЯ: {vacancy_text}
"""

# ============ АНАЛИЗ РЕЗЮМЕ ============

RESUME_ANALYSIS_PROMPT = """
ЗАДАЧА: Структурированное извлечение навыков и опыта из резюме.

АЛГОРИТМ АНАЛИЗА РЕЗЮМЕ:

1. ТЕХНИЧЕСКИЕ НАВЫКИ:
   - Конкретные технологии/инструменты
   - Уровень владения (если указан)
   - Контекст использования
   - Результаты применения

2. ПРОФЕССИОНАЛЬНЫЙ ОПЫТ:
   - Конкретные роли и обязанности
   - Достижения с цифрами
   - Проекты и их результаты
   - Индустрии и сферы

3. БИЗНЕС-РЕЗУЛЬТАТЫ:
   - Конкретные метрики и KPI
   - Улучшения процессов
   - Решённые проблемы
   - Созданная ценность

4. ОБРАЗОВАНИЕ И СЕРТИФИКАТЫ:
   - Формальное образование
   - Профессиональные сертификаты
   - Курсы и тренинги

5. ДОПОЛНИТЕЛЬНЫЕ АКТИВНОСТИ:
   - Волонтёрство
   - Проекты в свободное время
   - Публикации/выступления
   - Хобби, связанные с работой

ФОРМАТ ОТВЕТА: JSON
{{
  "technical_skills": [
    {{
      "skill": "конкретный навык",
      "level": "beginner/intermediate/advanced/expert",
      "context": "где и как использовал",
      "results": "какие результаты достиг",
      "keywords": ["ключевые", "слова"]
    }}
  ],
  "experience": [...],
  "achievements": [...],
  "education": [...],
  "additional": [...]
}}

РЕЗЮМЕ: {resume_text}
"""

# ============ АНАЛИЗ СОВПАДЕНИЙ ============

MATCHING_ANALYSIS_PROMPT = """
ЗАДАЧА: Найти ТОЧНЫЕ совпадения между требованиями вакансии и навыками в резюме.

КРИТИЧЕСКИ ВАЖНО:
1. Ищи КОНКРЕТНЫЕ совпадения, а не общие темы
2. Сопоставляй ТОЧНЫЕ термины и технологии
3. Не путай смежные отрасли (PropTech ≠ TravelTech)
4. Каждое совпадение должно иметь ДОКАЗАТЕЛЬСТВО из резюме

АЛГОРИТМ СОПОСТАВЛЕНИЯ:

1. ПРЯМЫЕ СОВПАДЕНИЯ (exact matches) - ОДИНАКОВЫЕ термины/процессы:
   Примеры: "OKR" в вакансии = "OKR" в резюме
           "управление бэклогом" = "работа с бэклогом"
           "UX-исследования" = "UX-тесты"
           "декомпозиция задач" = "декомпозиция на этапы"

2. СИЛЬНЫЕ СОВПАДЕНИЯ (strong matches) - СМЕЖНЫЕ навыки с доказательствами:
   Примеры: "B2B продукты" ← "B2B-решение PRYSM"
           "аналитическое мышление" ← "дерево метрик, NPV анализ"
           "запуск под ключ" ← "запустил MVP за 4 месяца"

3. СЛАБЫЕ СОВПАДЕНИЯ (weak matches) - ОБЩИЕ навыки:
   Примеры: "коммуникация", "работа в команде"

4. КРИТИЧЕСКИЕ ПРОБЕЛЫ (gaps) - ОТСУТСТВУЮЩИЕ жесткие требования:
   Примеры: Нет опыта в TravelTech (есть только PropTech)
           Нет прямого опыта А/В тестирования

5. КОМПЕНСИРУЮЩИЕ ФАКТОРЫ:
   Как смежный опыт может покрыть пробелы

ПРАВИЛА СОПОСТАВЛЕНИЯ:
- КОНКРЕТНОСТЬ > общность: "OKR квартальные" лучше чем "планирование"
- ДОКАЗАТЕЛЬСТВА: каждое совпадение подкрепляй ФАКТОМ из резюме
- ЧЕСТНОСТЬ: если требования нет - признай пробел, но покажи смежный опыт
- РЕЛЕВАНТНОСТЬ: показывай КАК опыт применим к новой роли

ФОРМАТ ОТВЕТА: JSON
{{
  "exact_matches": [
    {{
      "vacancy_requirement": "точное требование из вакансии",
      "resume_match": "точное совпадение в резюме", 
      "evidence": "конкретная цитата/факт из резюме",
      "relevance_score": 0.95,
      "bridge_explanation": "как именно этот опыт применим"
    }}
  ],
  "strong_matches": [
    {{
      "vacancy_requirement": "требование",
      "resume_match": "смежный опыт",
      "evidence": "доказательство",
      "relevance_score": 0.8,
      "bridge_explanation": "логическая связь"
    }}
  ],
  "weak_matches": [...],
  "critical_gaps": [
    {{
      "missing_requirement": "что отсутствует",
      "compensating_factor": "что может компенсировать",
      "mitigation_strategy": "как подать отсутствие опыта"
    }}
  ],
  "unique_advantages": [
    {{
      "advantage": "уникальное преимущество",
      "value_to_employer": "ценность для работодателя"
    }}
  ]
}}

АНАЛИЗ ВАКАНСИИ: {vacancy_analysis}
АНАЛИЗ РЕЗЮМЕ: {resume_analysis}
"""

# ============ ГЕНЕРАЦИЯ ПИСЬМА ============

LETTER_GENERATION_PROMPT = """
ЗАДАЧА: Написать сопроводительное письмо как СВЯЗНУЮ ИСТОРИЮ, а не список фактов.

У тебя есть ТОЧНЫЙ анализ совпадений между вакансией и резюме.

КРИТИЧЕСКАЯ ПРОБЛЕМА ТЕКУЩИХ ПИСЕМ:
❌ "У меня есть X. Также у меня есть Y. Кроме того, я делал Z."
✅ "Когда я работал с X, это научило меня Y, что позволило достичь Z."

ПРИНЦИПЫ СВЯЗНОЙ ИСТОРИИ:
1. ЛОГИЧЕСКАЯ ЦЕПОЧКА: каждый навык/результат вытекает из предыдущего
2. ПРИЧИННО-СЛЕДСТВЕННЫЕ СВЯЗИ: "благодаря этому", "это позволило", "поэтому"
3. ЕДИНАЯ НАРРАТИВА: все опыты работают на одну главную мысль
4. ПРОГРЕССИЯ: от простого к сложному, показать развитие

СВЯЗУЮЩИЕ СЛОВА И КОНСТРУКЦИИ:
- "Это научило меня..."
- "Благодаря опыту в X, я смог..."
- "Именно поэтому..."
- "Развивая навыки в X, я перешел к Y..."
- "Этот опыт подготовил меня к..."
- "Комбинируя X и Y, я достиг..."

АЛГОРИТМ СОЗДАНИЯ ИСТОРИИ:

1. НАЙДИ ГЛАВНУЮ ТЕМУ (сквозную линию):
   Что объединяет все твои навыки? Например:
   - "Системный подход к продуктовому развитию"
   - "Эволюция от тактических задач к стратегическим"
   - "Путь от анализа к запуску продуктов"

2. ВЫСТРОЙ ЛОГИЧЕСКУЮ ПОСЛЕДОВАТЕЛЬНОСТЬ:
   - Что было ОСНОВОЙ (фундаментальный навык)
   - Что РАЗВИЛОСЬ из этого (следующий уровень)  
   - К чему это ПРИВЕЛО (конечный результат)
   
   Пример: Анализ метрик → Понимание продукта → Управление командой → Запуск MVP

3. СОЗДАЙ ПРИЧИННО-СЛЕДСТВЕННЫЕ СВЯЗИ:
   Вместо: "Я управлял бэклогом. Я запустил MVP."
   Пиши: "Управляя бэклогом команды из 20 человек, я научился видеть продукт целиком, что позволило успешно запустить MVP за 4 месяца."

4. СТРУКТУРА ПИСЬМА С ЛОГИКОЙ:

   АБЗАЦ 1 - Зацепка + фундамент (30-40 слов):
   "Ваша вакансия привлекла тем, что [конкретная причина]. В [компании] я прошел путь от [начальная точка] до [результат], что дало мне [ключевой навык]."

   АБЗАЦ 2 - Развитие навыков (50-60 слов):
   "Именно [базовый опыт] научил меня [следующий навык]. Благодаря этому я смог [конкретное достижение], что привело к [результат с цифрами]."

   АБЗАЦ 3 - Применение и результат (40-50 слов):
   "Комбинируя [навык 1] и [навык 2], я [ключевое достижение]. Этот опыт показал, что [инсайт/понимание], именно поэтому [как это применимо к новой роли]."

   АБЗАЦ 4 - Призыв к действию (20-30 слов):
   "Готов обсудить, как этот опыт поможет [конкретная ценность для компании]. Когда удобно встретиться?"

5. ПРИМЕРЫ ЛОГИЧЕСКИХ СВЯЗОК:

   ПЛОХО: "Я работал с OKR. Я управлял бэклогом. Я запустил MVP."
   
   ХОРОШО: "Внедряя OKR в команде, я понял важность четкого планирования. Это помогло мне структурировать управление бэклогом так, что команда из 20 человек работала синхронно. Именно такой системный подход позволил запустить MVP всего за 4 месяца."

6. ПРОВЕРКА СВЯЗНОСТИ:
   - Можно ли убрать любое предложение без потери смысла? (❌ должно быть НЕТ)
   - Есть ли логическая цепочка от первого к последнему предложению? (✅ должно быть ДА)
   - Понятно ли, КАК каждый опыт повлиял на следующий? (✅ должно быть ДА)

ВХОДНЫЕ ДАННЫЕ:
{matching_analysis}

ПРИМЕР СВЯЗНОЙ ИСТОРИИ:
"Работа с продуктовыми метриками в банке научила меня видеть влияние каждого изменения на бизнес. Именно поэтому, когда перешел к управлению командой, я смог выстроить процессы так, что мы улучшили ключевые показатели на 15%. Этот системный подход к продукту помог запустить MVP за рекордные 4 месяца - команда понимала, к какому результату мы идем."

Напиши СВЯЗНУЮ ИСТОРИЮ, а не список фактов. Каждое предложение должно ЛОГИЧЕСКИ вытекать из предыдущего.
"""

# ============ ДЕ-ИИ-ФИКАЦИЯ ============

DEAI_PROMPT = """Проверь текст на ИИ-штампы и сделай его более человечным.

ДЕТЕКТИРУЕМЫЕ ПАТТЕРНЫ:
- "хотел бы выразить заинтересованность" 
- "рассмотрите мою кандидатуру"
- "идеально подхожу для позиции"
- "уникальная комбинация навыков"
- "готов внести значительный вклад"
- "буду рад возможности обсудить"
- "с нетерпением жду вашего ответа"
- "страстно увлечен"
- "также стоит упомянуть"
- "кроме того, хочу отметить"

ЗАМЕНИ НА ЧЕЛОВЕЧНЫЕ ВАРИАНТЫ:
- "заметил вашу вакансию и понял - это то, что искал"
- "ваше объявление привлекло внимание"
- "думаю, мой опыт здесь пригодится"
- "в [компания] мне довелось"
- "когда работал над [проект], столкнулся с"
- "за X лет работы в [сфера] научился"

ПРАВИЛА УЛУЧШЕНИЯ:
1. Убери все формальные обороты
2. Добавь живые детали и контекст
3. Замени общие фразы на конкретные примеры
4. Сделай переходы между предложениями естественными
5. Добавь эмоциональную составляющую, но без пафоса

ТЕКСТ ДЛЯ ПРОВЕРКИ:
{text}

Верни только улучшенный текст без дополнительных комментариев и пометок.""" 