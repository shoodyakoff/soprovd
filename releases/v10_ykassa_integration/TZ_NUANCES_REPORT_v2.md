# üìã –î–û–ü–û–õ–ù–ï–ù–ò–ï –ö –¢–ó v10.1 –ÆKassa Integration (–í—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è)

**–î–∞—Ç–∞:** 29 –∏—é–Ω—è 2025  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è  
**–ê–≤—Ç–æ—Ä:** AI Assistant

---

## 1. UI/UX –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Premium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ–ª–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
  - ‚úÖ Premium –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!
  - –õ–∏–º–∏—Ç: 20 –ø–∏—Å–µ–º –≤ –¥–µ–Ω—å
  - –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {period_end} (–¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏)
  - –ö–Ω–æ–ø–∫–∞ "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ" (–±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∏—Å—å–º–∞)

## 2. Backend-–ª–æ–≥–∏–∫–∞
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ webhook `payment.succeeded`:
  - –û–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ payments –Ω–∞ `succeeded`
  - –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å Premium –≤ subscriptions:
    - plan_type = 'premium'
    - letters_limit = 20
    - letters_used = 0
    - period_start = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
    - period_end = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ + 30 –¥–Ω–µ–π
    - status = 'active'
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ —Å–æ–±—ã—Ç–∏—è (payment –∏ –ø–æ–¥–ø–∏—Å–∫–∞)
  - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ (—Å–º. –≤—ã—à–µ)

## 3. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ webhook (event, payment_id, user_id)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–æ–¥–ø–∏—Å–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã:
  - –í payments —Å—Ç–∞—Ç—É—Å = succeeded
  - –í subscriptions plan_type = premium, –ª–∏–º–∏—Ç—ã –∏ –¥–∞—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –æ Premium
  - –ö–Ω–æ–ø–∫–∞ "–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ" —Ä–∞–±–æ—Ç–∞–µ—Ç

## 5. –¢–µ—Å—Ç–æ–≤—ã–π endpoint
- –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ webhook (POST /webhook/yookassa/test)

---

**–í–∞–∂–Ω–æ:** –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç—Ä–∞–∂–µ–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, changelog –∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö.

---

**–ü–µ—Ä–≤–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–æ–∫:** —Å–º. —Ñ–∞–π–ª `TZ_NUANCES_REPORT.md`
**–í—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª):** —Å–æ–¥–µ—Ä–∂–∏—Ç UX –∏ backend –¥–æ—Ä–∞–±–æ—Ç–∫–∏, –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –ë–î/–ª–æ–≥–æ–≤.

## üü¢ –ò—Ç–µ—Ä–∞—Ü–∏—è 3 (v10.1.1)
- –í–≤–µ–¥–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è Premium: –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–ø–ª–∞—Ç–µ –ø–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è, –∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ event loop, constraint, UX, —Ç–µ—Å—Ç–æ–≤–æ–≥–æ endpoint, –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü–æ–¥—Ä–æ–±–Ω–µ–µ: —Å–º. TZ_NUANCES_REPORT_v3.md 